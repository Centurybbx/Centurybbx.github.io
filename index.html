<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Century's Blog</title><meta name="author" content="Century"><meta name="copyright" content="Century"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="系统领域新手">
<meta property="og:type" content="website">
<meta property="og:title" content="Century&#39;s Blog">
<meta property="og:url" content="http://centurybbx.github.io/index.html">
<meta property="og:site_name" content="Century&#39;s Blog">
<meta property="og:description" content="系统领域新手">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://avatars.githubusercontent.com/u/55011513?v=4">
<meta property="article:author" content="Century">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://avatars.githubusercontent.com/u/55011513?v=4"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://centurybbx.github.io/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Century\'s Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-03-16 19:21:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/55011513?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Century's Blog"><span class="site-name">Century's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Century's Blog</h1><div id="site_social_icons"><a class="social-icon" href="https://github.com/Centurybbx" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/03/15/CMU-15-445-lecture-7/" title="CMU 15-445 lecture#7">CMU 15-445 lecture#7</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-15T13:54:48.000Z" title="发表于 2023-03-15 21:54:48">2023-03-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/15445/">15445</a></span></div><div class="content">Hash TablesHash Table哈希表的本质就是在一组无序的存有键值对的associative array。其空间复杂度为O(n)，时间复杂度平均为O(1)，最坏为O(n)。对于哈希表本身来说，其由两部分组成：

Hash Function
如何在大的key空间上映射小的domain
如何权衡快与慢（快的碰撞率高、满的碰撞率低）


Hashing Scheme
如何处理key之间的哈希碰撞
如何权衡直接申请大空间减少碰撞与使用额外策略解决碰撞



Hash Functions哈希函数即对于其输入，输出一个整数形式表示的key。该函数是deterministic的，即对于相同的输入有共同的输出。（相反，如果对于相同的输入有着不同的输出，则称 此函数为probabilistic function）在数据库领域使用的哈希函数与密码学领域有所不同，数据库领域的哈希函数主要在一两个指标：一是速度，二是碰撞率；而密码学的哈希函数会更侧重于不可反向推导（安全性）。目前主流的哈希函数是Facebook XXHash3。

关于两种哈希函数，Stackoverflow给出的一种解读：

S ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/03/11/CMU-15-445-lecture-6/" title="CMU 15-445 lecture#6">CMU 15-445 lecture#6</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-11T15:16:15.000Z" title="发表于 2023-03-11 23:16:15">2023-03-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/15445/">15445</a></span></div><div class="content">Memory Management之前的课程中介绍了DBMS是如何在磁盘上表示数据库上的文件，但由于文件一般存储在磁盘上，每次retrieve时需要先把磁盘上的数据读取到内存中，再从内存中读取数据返回给用户。对于Execution Engine而言，其不用考虑需要得到的page是否在memory中（因为最好的情况是所有需要retrieve的page都存在于memory中）。上述描述的问题可以归结为空间和时间问题：

空间上：where pages are physically written on disk. The goal of spatial control is to keep pages that are used together often as physically close together as possible on disk.
时间上： when to read pages into memory and when to write them to disk. Temporal control aims to minimize the number of st ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/03/11/CMU-15-445-lecture-5/" title="CMU 15-445 lecture#5">CMU 15-445 lecture#5</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-11T15:15:35.000Z" title="发表于 2023-03-11 23:15:35">2023-03-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/15445/">15445</a></span></div><div class="content">Database WorkloadsOLTPOLTP：On-Line Transaction Processing  

 Fast operations that only read&#x2F;update a small amount of data each time.  

常用来做业务层面的数据存储和处理，主要服务对象为客户。其特点在于操作较快，常用于简单在单个实体上进行查询，其写操作多于读操作。
OLAPOLAP：On-Line Analytical Processing  

 Complex queries that read a lot of data to compute aggregates.  

常用来做数据聚合和处理，主要服务对象为企业。其特点在于需要长时间处理，对在OLAP中的数据进行复杂处理和分析。
HTAPHTAP：Hybrid Transaction + Analytical Processing

 OLTP + OLAP together on the same database instance.

OLTP和OLAP的结合体。
Storage ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/03/11/CMU-15-445-lecture-4/" title="CMU 15-445 lecture#4">CMU 15-445 lecture#4</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-11T15:14:32.000Z" title="发表于 2023-03-11 23:14:32">2023-03-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/15445/">15445</a></span></div><div class="content">Database Storage II在CMU 15-445 Lecture 4介绍了Disk Oriented的数据存储，其使用slot array来进行page的存储管理，但仔细想想这种存储管理方式也存在一定的问题：

碎片：在page中队tuple的删除可能会导致碎片
无用的硬盘I&#x2F;O：假设读取少量数据，但其需要获取整个块来获得该tuple
随机硬盘I&#x2F;O：假设存在20个tuple需要更改，其分别存储在不同地方， 那么每次都要去硬盘里读取才可完成

因此引入了下面的一种数据结构，叫做Log-Structured Storage，它是一种只写性质的存储模型（bitcask这种append-only就属于这种结构）。
Log-StructuredStorage不同于需要重写的存储管理，此种结构只需记录log来完成存储，并把log放在tuple中进行存储。当需要进行更改时，DBMS只需从后往前（newest-&gt;oldest）查看即可得到相应的更改信息。其中由于刚开始的时候page是存储在内存中的，当内存中存满时会将其内容写入到磁盘中，这个过程中有两个特点：

 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/03/11/CMU-15-445-lecture-3/" title="CMU 15-445 lecture#3">CMU 15-445 lecture#3</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-11T09:36:19.000Z" title="发表于 2023-03-11 17:36:19">2023-03-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/15445/">15445</a></span></div><div class="content">Database Storage IStorage本节课主要将面向存储在硬盘上的数据库，对于DBMS来说数据库的数据存储位置主要在于Non-volatile disk（即硬盘），根据读取效率进行分层的话可具体分成如下几类：

其中在SSD和DRAM之间存在一层Persistent Memory，可以将其视作为非易失性的内存，其拥有Memory的读取速度但断电后数据不丢失。
Disk-Oriented DBMS首先要明确一点，文件的存储不能依赖于OS（例如mmap）。在DBMS中，与数据有关的操作大都要通过其本身进行管理（尽管许多操作与OS是相似的）。在以硬盘存储为基础的数据库，其数据是以page的形式存储在硬盘上，但为了操作其中的数据，磁盘上层定义了buffer poll来管理数据在内存和硬盘之间的流动；大致流程见下图所示：


File StorageDBMS将多个以某种组合方式形成的文件存储在数据库中，其中DBMS中的storage manager是用来管理数据库文件的，它通过将文件组织成pages的集合，并且可以追踪哪些数据被读写&#x2F;哪些pages中含有空闲空间。
Dat ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/03/10/hello-world/" title="Hello World">Hello World</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-10T03:32:39.526Z" title="发表于 2023-03-10 11:32:39">2023-03-10</time></span></div><div class="content">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.
Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;

More info: Writing
Run server1$ hexo server

More info: Server
Generate static files1$ hexo generate

More info: Generating
Deploy to remote sites1$ hexo deploy

More info: Deployment
</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/55011513?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Century</div><div class="author-info__description">系统领域新手</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Centurybbx" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/15/CMU-15-445-lecture-7/" title="CMU 15-445 lecture#7">CMU 15-445 lecture#7</a><time datetime="2023-03-15T13:54:48.000Z" title="发表于 2023-03-15 21:54:48">2023-03-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/11/CMU-15-445-lecture-6/" title="CMU 15-445 lecture#6">CMU 15-445 lecture#6</a><time datetime="2023-03-11T15:16:15.000Z" title="发表于 2023-03-11 23:16:15">2023-03-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/11/CMU-15-445-lecture-5/" title="CMU 15-445 lecture#5">CMU 15-445 lecture#5</a><time datetime="2023-03-11T15:15:35.000Z" title="发表于 2023-03-11 23:15:35">2023-03-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/11/CMU-15-445-lecture-4/" title="CMU 15-445 lecture#4">CMU 15-445 lecture#4</a><time datetime="2023-03-11T15:14:32.000Z" title="发表于 2023-03-11 23:14:32">2023-03-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/11/CMU-15-445-lecture-3/" title="CMU 15-445 lecture#3">CMU 15-445 lecture#3</a><time datetime="2023-03-11T09:36:19.000Z" title="发表于 2023-03-11 17:36:19">2023-03-11</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/15445/"><span class="card-category-list-name">15445</span><span class="card-category-list-count">5</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/database/" style="font-size: 1.1em; color: #999">database</a> <a href="/tags/lecture/" style="font-size: 1.1em; color: #999">lecture</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">6</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">6</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-03-16T11:21:51.517Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Century</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>