---
/* ===========================================
   Projects Page (/projects)
   ===========================================

   Features:
   - List all projects from data file
   - Each project has detail view with playable demo
   - Game projects can be embedded via iframe
   - Smooth anchor navigation

   Future enhancements:
   - Add filtering by tech stack
   - Add search functionality
   - Add project screenshots gallery
   - Add case study pages
*/

import BaseLayout from '../layouts/BaseLayout.astro';
import GameEmbed from '../components/GameEmbed.jsx';
import { getProjects } from '../data/projects';

const projects = await getProjects();
---

<BaseLayout title="Projects" activePage="projects">
  <header class="page-header">
    <h1>Projects</h1>
    <p class="text-muted">
      A collection of experiments, games, and tools I've built.
      Click on a project to play the demo.
    </p>
  </header>

  <div class="projects-list">
    {projects.map((project) => (
      <article id={project.id} class="project-section">
        <div class="project-info">
          <h2>{project.title}</h2>
          <p>{project.description}</p>

          <div class="project-meta">
            <div class="tech-stack">
              {project.tech.map((tech) => (
                <span class="tech-tag">{tech}</span>
              ))}
            </div>

            <a href={project.demoUrl} target="_blank" rel="noopener noreferrer" class="btn">
              Open in new tab ↗
            </a>
          </div>

          <div class="project-description">
            <p>{project.longDescription}</p>
          </div>
        </div>

        <div class="project-demo">
          {project.isGame ? (
            <GameEmbed
              gameId={project.id}
              src={project.demoUrl}
              title={project.title}
            />
          ) : (
            <div class="demo-placeholder card">
              <p class="text-center text-muted">
                <a href={project.demoUrl} target="_blank" rel="noopener noreferrer">
                  View Live Demo →
                </a>
              </p>
            </div>
          )}
        </div>
      </article>
    ))}
  </div>
</BaseLayout>

<style>
  .page-header {
    margin-bottom: var(--space-2xl);
  }

  .page-header h1 {
    margin-bottom: var(--space-sm);
  }

  .projects-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xl);
  }

  .project-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-xl);
    padding: var(--space-xl) 0;
    border-bottom: 1px solid var(--color-border);
  }

  .project-section:last-child {
    border-bottom: none;
  }

  .project-info h2 {
    margin-bottom: var(--space-sm);
  }

  .project-info p {
    color: var(--color-text-muted);
    margin-bottom: var(--space-md);
  }

  .project-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-lg);
    flex-wrap: wrap;
    gap: var(--space-md);
  }

  .tech-stack {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
  }

  .tech-tag {
    font-size: 0.75rem;
    padding: 4px 10px;
    background: var(--color-bg);
    border-radius: 4px;
    color: var(--color-text-muted);
    font-family: var(--font-mono);
  }

  .project-description {
    font-size: 0.95rem;
    line-height: 1.7;
  }

  .project-demo {
    min-height: 300px;
  }

  .demo-placeholder {
    height: 100%;
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  @media (max-width: 768px) {
    .project-section {
      grid-template-columns: 1fr;
    }

    .project-demo {
      order: -1;
      min-height: 250px;
    }
  }
</style>
